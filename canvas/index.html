<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>
<style>
	html,
	body {
		margin: 0;
		padding: 0;
	}

	canvas {
		display: block;
	}
</style>

<body>
	<script src="https://cdn.jsdelivr.net/npm/p5@1.5.0/lib/p5.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/addons/p5.sound.min.js" integrity="sha512-WzkwpdWEMAY/W8WvP9KS2/VI6zkgejR4/KTxTl4qHx0utqeyVE0JY+S1DlMuxDChC7x0oXtk/ESji6a0lP/Tdg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script>

		// let mic, fft;
		// function setup() {
		// 	createCanvas(windowWidth, windowHeight);


		// 	mic = new p5.AudioIn();
		// 	mic.start();
		// 	fft = new p5.FFT();
		// 	fft.setInput(mic);
		// }

		// function draw() {
		// 	background(0);



		// 	for (let i = 40; i < width - 10; i = i + (width / 12)) {
		// 		for (let j = 40; j < height - 30; j = j + (height / 3)) {
		// 			micLevel = mic.getLevel();
		// 			let j = height - micLevel * height;
		// 			noStroke();
		// 			fill(180, 8 + 2 * (i / 30) + 2 * (j / 30), 0);
		// 			ellipse(i, j, 8 + 2 * (i / 120) + 2 * (j / 120), 8 + 2 * (i / 120) + 2 * (j / 120));
		// 		}
		// 	}
		// }


		let mic, fft;

		function setup() {
			createCanvas(710, 400);
			noFill();

			mic = new p5.AudioIn();
			mic.start();
			fft = new p5.FFT();
			fft.setInput(mic);
		}

		function draw() {
			background(200);

			let spectrum = fft.analyze();
			let vol = mic.getLevel();


			beginShape();
			// plot FFT.analyze() frequency analysis on the canvas

			for (let i = 0; i < spectrum.length / 20; i++) {
				fill(spectrum[i], spectrum[i] / 10, 0);
				let x = map(i, 0, spectrum.length / 20, 0, width);
				let h = map(spectrum[i], 0, 255, 0, height);
				rect(x, height, spectrum.length / 20, -h);
			}
			endShape();
		}





	</script>
</body>

</html>